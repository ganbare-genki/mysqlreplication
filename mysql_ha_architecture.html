<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MySQL HA Architecture</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .title {
            text-align: center;
            color: #2c3e50;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .architecture {
            display: flex;
            flex-direction: column;
            gap: 30px;
            align-items: center;
        }
        
        .layer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            width: 100%;
            position: relative;
        }
        
        .component {
            background: linear-gradient(145deg, #f0f0f0, #ffffff);
            border: 2px solid #3498db;
            border-radius: 15px;
            padding: 15px 20px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .component:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.15);
        }
        
        .component h3 {
            margin: 0 0 5px 0;
            color: #2c3e50;
            font-size: 16px;
        }
        
        .component p {
            margin: 2px 0;
            color: #7f8c8d;
            font-size: 12px;
        }
        
        .client { border-color: #9b59b6; background: linear-gradient(145deg, #f8f4ff, #ffffff); }
        .vip { border-color: #e74c3c; background: linear-gradient(145deg, #fff4f4, #ffffff); }
        .router { border-color: #27ae60; background: linear-gradient(145deg, #f4fff4, #ffffff); }
        .mysql { border-color: #f39c12; background: linear-gradient(145deg, #fff9f0, #ffffff); }
        
        .arrow {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            bottom: -15px;
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 20px solid #3498db;
            z-index: 10;
        }
        
        .connection-line {
            position: absolute;
            background: #3498db;
            height: 3px;
            border-radius: 2px;
        }
        
        .specs {
            background: linear-gradient(145deg, #ecf0f1, #ffffff);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            border: 2px solid #95a5a6;
        }
        
        .specs h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        
        .spec-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .spec-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }
        
        .status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            color: white;
            background: #27ae60;
        }
        
        .status.warning { 
            background: #f39c12; 
        }
        
        .status.error { 
            background: #e74c3c; 
        }
        
        .port {
            display: inline-block;
            background: #34495e;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            margin: 2px;
        }
        
        .flow-text {
            position: absolute;
            right: -100px;
            top: 50%;
            transform: translateY(-50%);
            background: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            white-space: nowrap;
        }
        
        @media (max-width: 768px) {
            .layer {
                flex-direction: column;
                gap: 15px;
            }
            .component {
                min-width: 250px;
            }
            .flow-text {
                position: static;
                margin: 10px 0;
                transform: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">üöÄ MySQL High Availability Architecture</h1>
        
        <div class="architecture">
            <!-- Client Layer -->
            <div class="layer">
                <div class="component client">
                    <h3>üñ•Ô∏è Application</h3>
                    <p>Client Application</p>
                    <p><strong>Connection:</strong> 192.168.1.250:3306</p>
                    <span class="status">CONNECTED</span>
                </div>
                <div class="arrow"></div>
            </div>

            <!-- VIP Layer -->
            <div class="layer">
                <div class="component vip">
                    <h3>üåü Virtual IP (VIP)</h3>
                    <p><strong>IP:</strong> 192.168.1.250</p>
                    <p><span class="port">3306</span> Read-Write</p>
                    <p><span class="port">3307</span> Read-Only</p>
                    <p><strong>Managed by:</strong> Keepalived</p>
                    <span class="status">ACTIVE</span>
                </div>
                <div class="arrow"></div>
            </div>

            <!-- Router Layer -->
            <div class="layer">
                <div class="component router">
                    <h3>‚öñÔ∏è Router1 (MASTER)</h3>
                    <p><strong>Hostname:</strong> router1.lab.local</p>
                    <p><strong>IP:</strong> 192.168.1.254</p>
                    <p>MySQL Router + HAProxy + Keepalived</p>
                    <p><span class="port">6446</span> <span class="port">6447</span> <span class="port">3306</span> <span class="port">3307</span></p>
                    <span class="status">MASTER</span>
                </div>
                
                <div class="component router">
                    <h3>‚öñÔ∏è Router2 (BACKUP)</h3>
                    <p><strong>Hostname:</strong> router2.lab.local</p>
                    <p><strong>IP:</strong> 192.168.1.13</p>
                    <p>MySQL Router + HAProxy + Keepalived</p>
                    <p><span class="port">6446</span> <span class="port">6447</span> <span class="port">3306</span> <span class="port">3307</span></p>
                    <span class="status">BACKUP</span>
                </div>
                <div class="arrow"></div>
            </div>

            <!-- MySQL Cluster Layer -->
            <div class="layer">
                <div class="component mysql">
                    <h3>üóÑÔ∏è MySQL Primary</h3>
                    <p><strong>IP:</strong> 192.168.1.209</p>
                    <p><span class="port">3306</span></p>
                    <p><strong>Role:</strong> PRIMARY</p>
                    <p><strong>Mode:</strong> Read-Write</p>
                    <span class="status">ONLINE</span>
                </div>
                
                <div class="component mysql">
                    <h3>üóÑÔ∏è MySQL Secondary</h3>
                    <p><strong>IP:</strong> 192.168.1.70</p>
                    <p><span class="port">3306</span></p>
                    <p><strong>Role:</strong> SECONDARY</p>
                    <p><strong>Mode:</strong> Read-Only</p>
                    <span class="status">ONLINE</span>
                </div>
                
                <div class="component mysql">
                    <h3>üóÑÔ∏è MySQL Secondary</h3>
                    <p><strong>IP:</strong> 192.168.1.180</p>
                    <p><span class="port">3306</span></p>
                    <p><strong>Role:</strong> SECONDARY</p>
                    <p><strong>Mode:</strong> Read-Only</p>
                    <span class="status">ONLINE</span>
                </div>
            </div>
        </div>

        <div class="specs">
            <h3>üìã System Specifications</h3>
            <div class="spec-grid">
                <div class="spec-item">
                    <h4>üîÑ MySQL Group Replication</h4>
                    <p><strong>Cluster Mode:</strong> Single-Primary</p>
                    <p><strong>Primary Node:</strong> 192.168.1.209</p>
                    <p><strong>Secondary Nodes:</strong> 192.168.1.70, 192.168.1.180</p>
                    <p><strong>Replication:</strong> Synchronous</p>
                </div>
                
                <div class="spec-item">
                    <h4>üîÄ MySQL Router Load Balancing</h4>
                    <p><strong>Read-Write Port:</strong> 6446 ‚Üí Primary (209)</p>
                    <p><strong>Read-Only Port:</strong> 6447 ‚Üí Secondary (70, 180)</p>
                    <p><strong>Strategy:</strong> Round-Robin (Read-Only)</p>
                    <p><strong>Strategy:</strong> First-Available (Read-Write)</p>
                </div>
                
                <div class="spec-item">
                    <h4>‚öñÔ∏è HAProxy Configuration</h4>
                    <p><strong>Frontend:</strong> *:3306 (Read-Write)</p>
                    <p><strong>Frontend:</strong> *:3307 (Read-Only)</p>
                    <p><strong>Backend:</strong> 127.0.0.1:6446/6447</p>
                    <p><strong>Health Check:</strong> TCP Check</p>
                </div>
                
                <div class="spec-item">
                    <h4>üåü Keepalived HA</h4>
                    <p><strong>Virtual IP:</strong> 192.168.1.250</p>
                    <p><strong>VRRP ID:</strong> 51</p>
                    <p><strong>Master Priority:</strong> 130 (Router1)</p>
                    <p><strong>Backup Priority:</strong> 120 (Router2)</p>
                    <p><strong>Health Check:</strong> HAProxy status</p>
                </div>
        </div>

        <div class="specs">
            <h3>üîÑ Data Flow Process</h3>
            <div class="spec-grid">
                <div class="spec-item">
                    <h4>üìù Write Operations (INSERT/UPDATE/DELETE)</h4>
                    <p>1. Azure Data Studio ‚Üí VIP:3306</p>
                    <p>2. HAProxy ‚Üí MySQL Router:6446</p>
                    <p>3. MySQL Router ‚Üí Primary Node (209)</p>
                    <p>4. Group Replication ‚Üí All nodes sync</p>
                </div>
                
                <div class="spec-item">
                    <h4>üìñ Read Operations (SELECT)</h4>
                    <p>1. Azure Data Studio ‚Üí VIP:3307</p>
                    <p>2. HAProxy ‚Üí MySQL Router:6447</p>
                    <p>3. MySQL Router ‚Üí Secondary Nodes (70, 180)</p>
                    <p>4. Round-robin load balancing</p>
                </div>
                
                <div class="spec-item">
                    <h4>‚ö†Ô∏è Failover Scenario</h4>
                    <p>1. Router1 HAProxy fails</p>
                    <p>2. Keepalived detects failure (~6 sec)</p>
                    <p>3. VIP moves to Router2</p>
                    <p>4. Traffic continues seamlessly</p>
                </div>
                
                <div class="spec-item">
                    <h4>üîÑ Failback Scenario</h4>
                    <p>1. Router1 HAProxy recovers</p>
                    <p>2. Keepalived detects recovery</p>
                    <p>3. VIP returns to Router1 (higher priority)</p>
                    <p>4. Normal operations resume</p>
                </div>
            </div>
        </div>

        <div class="specs">
            <h3>üîÑ Traffic Flow Scenarios</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 20px;">
                <!-- Write Scenario -->
                <div style="background: linear-gradient(145deg, #fff4f4, #ffffff); border: 3px solid #e74c3c; border-radius: 15px; padding: 25px;">
                    <div style="font-size: 20px; font-weight: bold; margin-bottom: 20px; text-align: center; padding: 10px; border-radius: 10px; color: white; background: #e74c3c;">
                        üìù WRITE Operations (INSERT/UPDATE/DELETE)
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #e74c3c; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #e74c3c; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">1</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">Application Connection</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.250</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #9b59b6; color: white; padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px;">3306</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">Application connects to Virtual IP on port 3306 for write operations</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #e74c3c; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #e74c3c; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">2</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">Keepalived VIP Routing</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.250</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.254</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">VIP routes traffic to active router (Router1 - MASTER)</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #e74c3c; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #e74c3c; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">3</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">HAProxy Frontend</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.254</span>
                            <span style="background: #9b59b6; color: white; padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px;">3306</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #fff3cd; padding: 2px 4px; border-radius: 3px; font-weight: bold;">mysql_read_write</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">HAProxy receives connection on port 3306 frontend</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #e74c3c; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #e74c3c; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">4</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">HAProxy Backend</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">127.0.0.1</span>
                            <span style="background: #9b59b6; color: white; padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px;">6446</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #fff3cd; padding: 2px 4px; border-radius: 3px; font-weight: bold;">MySQL Router</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">HAProxy forwards to local MySQL Router on port 6446</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #e74c3c; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #e74c3c; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">5</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">MySQL Router (Read-Write)</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.209</span>
                            <span style="background: #9b59b6; color: white; padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px;">3306</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #fff3cd; padding: 2px 4px; border-radius: 3px; font-weight: bold;">PRIMARY Node</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">Router forwards to PRIMARY MySQL node for write operations</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #e74c3c; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #e74c3c; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">6</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">Group Replication Sync</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.70</span>
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.180</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üê</span>
                            <span style="background: #fff3cd; padding: 2px 4px; border-radius: 3px; font-weight: bold;">Sync</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">PRIMARY synchronizes data to SECONDARY nodes</div>
                    </div>
                </div>
                
                <!-- Read Scenario -->
                <div style="background: linear-gradient(145deg, #f4fff4, #ffffff); border: 3px solid #27ae60; border-radius: 15px; padding: 25px;">
                    <div style="font-size: 20px; font-weight: bold; margin-bottom: 20px; text-align: center; padding: 10px; border-radius: 10px; color: white; background: #27ae60;">
                        üìñ READ Operations (SELECT)
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #27ae60; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #27ae60; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">1</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">Application Connection</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.250</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #9b59b6; color: white; padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px;">3307</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">Application connects to Virtual IP on port 3307 for read operations</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #27ae60; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #27ae60; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">2</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">Keepalived VIP Routing</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.250</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.254</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">VIP routes traffic to active router (Router1 - MASTER)</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #27ae60; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #27ae60; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">3</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">HAProxy Frontend</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">192.168.1.254</span>
                            <span style="background: #9b59b6; color: white; padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px;">3307</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #fff3cd; padding: 2px 4px; border-radius: 3px; font-weight: bold;">mysql_read_only</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">HAProxy receives connection on port 3307 frontend</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #27ae60; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #27ae60; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">4</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">HAProxy Backend</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span style="background: #34495e; color: white; padding: 5px 10px; border-radius: 5px; font-family: 'Courier New', monospace; font-weight: bold;">127.0.0.1</span>
                            <span style="background: #9b59b6; color: white; padding: 3px 8px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 12px;">6447</span>
                            <span style="font-size: 20px; color: #3498db; font-weight: bold;">‚Üí</span>
                            <span style="background: #fff3cd; padding: 2px 4px; border-radius: 3px; font-weight: bold;">MySQL Router</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px;">HAProxy forwards to local MySQL Router on port 6447</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #27ae60; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #27ae60; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">5</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">MySQL Router (Read-Only)</div>
                        <div style="color: #7f8c8d; font-size: 14px;">Router distributes queries to SECONDARY nodes using Round-Robin</div>
                    </div>
                    
                    <div style="background: white; margin: 15px 0; padding: 15px; border-radius: 10px; border-left: 5px solid #27ae60; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative;">
                        <div style="position: absolute; left: -15px; top: 15px; background: #27ae60; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px;">6</div>
                        <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">Load Balancing Pattern</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 5px 0;">
                            <span style="background: #34495e; color: white; padding: 3px 8px; border-radius: 5px; font-family: 'Courier New', monospace; font-size: 12px;">Query 1 ‚Üí 192.168.1.70</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 5px 0;">
                            <span style="background: #34495e; color: white; padding: 3px 8px; border-radius: 5px; font-family: 'Courier New', monospace; font-size: 12px;">Query 2 ‚Üí 192.168.1.180</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 5px 0;">
                            <span style="background: #34495e; color: white; padding: 3px 8px; border-radius: 5px; font-family: 'Courier New', monospace; font-size: 12px;">Query 3 ‚Üí 192.168.1.70</span>
                        </div>
                        <div style="color: #7f8c8d; font-size: 14px; margin-top: 10px;">Continuous round-robin distribution across SECONDARY nodes</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="specs">
            <h3>üîÑ Router Status & Failover Scenarios</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div style="background: linear-gradient(145deg, #e8f5e8, #ffffff); border: 2px solid #27ae60; border-radius: 10px; padding: 20px;">
                    <div style="font-weight: bold; color: #2c3e50; margin-bottom: 10px; font-size: 16px;">üü¢ Router1 (MASTER) - Normal Operation</div>
                    <p><strong>IP:</strong> 192.168.1.254</p>
                    <p><strong>VIP Status:</strong> ACTIVE (192.168.1.250)</p>
                    <p><strong>HAProxy:</strong> Running</p>
                    <p><strong>Keepalived Priority:</strong> 130</p>
                    <p><strong>Traffic Route:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li style="margin: 5px 0; font-size: 12px;">Write: VIP:3306 ‚Üí 254:3306 ‚Üí 127.0.0.1:6446 ‚Üí 209:3306</li>
                        <li style="margin: 5px 0; font-size: 12px;">Read: VIP:3307 ‚Üí 254:3307 ‚Üí 127.0.0.1:6447 ‚Üí 70/180:3306</li>
                    </ul>
                </div>
                
                <div style="background: linear-gradient(145deg, #fff9e6, #ffffff); border: 2px solid #f39c12; border-radius: 10px; padding: 20px;">
                    <div style="font-weight: bold; color: #2c3e50; margin-bottom: 10px; font-size: 16px;">üü° Router2 (BACKUP) - Standby Mode</div>
                    <p><strong>IP:</strong> 192.168.1.13</p>
                    <p><strong>VIP Status:</strong> STANDBY</p>
                    <p><strong>HAProxy:</strong> Running (Ready)</p>
                    <p><strong>Keepalived Priority:</strong> 120</p>
                    <p><strong>Ready to Route:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li style="margin: 5px 0; font-size: 12px;">Write: VIP:3306 ‚Üí 13:3306 ‚Üí 127.0.0.1:6446 ‚Üí 209:3306</li>
                        <li style="margin: 5px 0; font-size: 12px;">Read: VIP:3307 ‚Üí 13:3307 ‚Üí 127.0.0.1:6447 ‚Üí 70/180:3306</li>
                    </ul>
                </div>
            </div>
            
            <h4 style="font-size: 18px; font-weight: bold; color: #2c3e50; margin: 20px 0 15px 0;">‚ö†Ô∏è Failover Traffic Flow</h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div style="background: linear-gradient(145deg, #fff3e0, #ffffff); border: 2px solid #f39c12; border-radius: 10px; padding: 20px;">
                    <div style="font-weight: bold; color: #2c3e50; margin-bottom: 10px; font-size: 16px;">üî¥ Router1 HAProxy Failed</div>
                    <p><strong>Priority Change:</strong> 130 - 20 = 110</p>
                    <p><strong>VIP Status:</strong> LOST (Priority < Router2)</p>
                    <p><strong>Traffic Impact:</strong> ~6-10 second interruption</p>
                    <p><strong>Detection:</strong> systemctl is-active haproxy</p>
                </div>
                
                <div style="background: linear-gradient(145deg, #e8f5e8, #ffffff); border: 2px solid #27ae60; border-radius: 10px; padding: 20px;">
                    <div style="font-weight: bold; color: #2c3e50; margin-bottom: 10px; font-size: 16px;">üü¢ Router2 Takes Over</div>
                    <p><strong>Priority:</strong> 120 (Higher than Router1's 110)</p>
                    <p><strong>VIP Status:</strong> ACTIVE (192.168.1.250 ‚Üí 192.168.1.13)</p>
                    <p><strong>New Traffic Route:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li style="margin: 5px 0; font-size: 12px;">Write: VIP:3306 ‚Üí 13:3306 ‚Üí 127.0.0.1:6446 ‚Üí 209:3306</li>
                        <li style="margin: 5px 0; font-size: 12px;">Read: VIP:3307 ‚Üí 13:3307 ‚Üí 127.0.0.1:6447 ‚Üí 70/180:3306</li>
                    </ul>
                    <p><strong>Result:</strong> Seamless continuation of service</p>
                </div>
            </div>
        </div>

        <div class="specs">
            <h3>üìä IP & Port Summary Table</h3>
            <table style="width: 100%; border-collapse: collapse; margin: 20px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                <thead style="background: #34495e; color: white;">
                    <tr>
                        <th style="padding: 15px; border: 1px solid #2c3e50; text-align: left;">Component</th>
                        <th style="padding: 15px; border: 1px solid #2c3e50; text-align: left;">IP Address</th>
                        <th style="padding: 15px; border: 1px solid #2c3e50; text-align: left;">Ports</th>
                        <th style="padding: 15px; border: 1px solid #2c3e50; text-align: left;">Purpose</th>
                        <th style="padding: 15px; border: 1px solid #2c3e50; text-align: left;">Traffic Type</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="background: #fff3cd;">
                        <td style="padding: 12px; border: 1px solid #dee2e6;"><strong>Virtual IP (VIP)</strong></td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; font-family: 'Courier New', monospace;">192.168.1.250</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">
                            <span class="port">3306</span> <span class="port">3307</span>
                        </td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">Application Entry Point</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">All Traffic</td>
                    </tr>
                    <tr style="background: #d4edda;">
                        <td style="padding: 12px; border: 1px solid #dee2e6;"><strong>Router1 (MASTER)</strong></td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; font-family: 'Courier New', monospace;">192.168.1.254</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">
                            <span class="port">3306</span> <span class="port">3307</span> <span class="port">6446</span> <span class="port">6447</span>
                        </td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">Active HA Router</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">Primary Route</td>
                    </tr>
                    <tr style="background: #fff3e0;">
                        <td style="padding: 12px; border: 1px solid #dee2e6;"><strong>Router2 (BACKUP)</strong></td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; font-family: 'Courier New', monospace;">192.168.1.13</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">
                            <span class="port">3306</span> <span class="port">3307</span> <span class="port">6446</span> <span class="port">6447</span>
                        </td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">Standby HA Router</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">Failover Route</td>
                    </tr>
                    <tr style="background: #f8d7da;">
                        <td style="padding: 12px; border: 1px solid #dee2e6;"><strong>MySQL Primary</strong></td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; font-family: 'Courier New', monospace;">192.168.1.209</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">
                            <span class="port">3306</span>
                        </td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">Write Operations</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">INSERT/UPDATE/DELETE</td>
                    </tr>
                    <tr style="background: #d1ecf1;">
                        <td style="padding: 12px; border: 1px solid #dee2e6;"><strong>MySQL Secondary 1</strong></td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; font-family: 'Courier New', monospace;">192.168.1.70</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">
                            <span class="port">3306</span>
                        </td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">Read Operations</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">SELECT (Round-Robin)</td>
                    </tr>
                    <tr style="background: #d1ecf1;">
                        <td style="padding: 12px; border: 1px solid #dee2e6;"><strong>MySQL Secondary 2</strong></td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; font-family: 'Courier New', monospace;">192.168.1.180</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">
                            <span class="port">3306</span>
                        </td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">Read Operations</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6;">SELECT (Round-Robin)</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>